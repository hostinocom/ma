---
// FaqSection.astro - Optimized for performance

const faqData = [
  {
    question: "C'est quoi l'hébergement d'un site web ?",
    answer: `
      <p class="mb-4">
        Imaginez votre site web comme une maison. Pour qu'elle soit visible
        sur internet, il lui faut un terrain. C'est là qu'intervient
        l'hébergement web.
      </p>
      <ul class="space-y-3 mb-4">
        <li class="flex items-start gap-2">
          <svg class="w-5 h-5 text-primary flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
          </svg>
          <span>
            L'hébergement web, c'est la location d'un espace sur un serveur
            puissant, connecté à internet.
          </span>
        </li>
        <li class="flex items-start gap-2">
          <svg class="w-5 h-5 text-primary flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
          </svg>
          <span>
            C'est sur cet espace que seront stockés tous les fichiers de
            votre site web (textes, images, vidéos...).
          </span>
        </li>
        <li class="flex items-start gap-2">
          <svg class="w-5 h-5 text-primary flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
          </svg>
          <span>
            L'hébergeur web, c'est le propriétaire du terrain. Il vous
            fournit l'espace et s'occupe de tout pour que votre site web
            soit accessible 24/24h et 7/7j.
          </span>
        </li>
      </ul>
      <p>
        Pour que votre site web soit accessible, il vous faut un nom de
        domaine, que la plupart des hébergeurs web vous permettent d'acheter
        en même temps que votre pack d'hébergement, et ils peuvent vous
        aider à en choisir et à l'enregistrer si vous n'en avez pas encore.
      </p>
    `,
  },
  {
    question: "Quel est le meilleur hébergeur web ?",
    answer:
      "Que vous soyez un particulier, une petite entreprise ou une grande organisation, Hostino™ a la solution d'hébergement web qu'il vous faut. Avec ses performances, sa fiabilité, ses fonctionnalités complètes et ses prix abordables, Hostino™ est le choix idéal pour héberger votre site web au Maroc.",
  },
  {
    question:
      "Est-il possible de modifier le pack d'hébergement web après souscription ?",
    answers: [
      "Bien sûr ! Toutes nos offres d'hébergement sont flexibles et ajustables selon vos exigences. Vous avez la possibilité de passer de l'hébergement web Starty® à l'hébergement Business® ou à Cloudy® à tout moment via votre espace client.",
      "Cette mise à niveau s'effectue automatiquement et sans aucune interruption de service.",
    ],
  },
  {
    question: "Quels sont les délais d'activation de ma commande ?",
    answers: [
      "L'activation de votre hébergement web est quasi instantanée. Dès validation de votre paiement, votre espace d'hébergement est configuré et accessible dans les minutes qui suivent.",
      "Vous recevrez vos identifiants de connexion par email immédiatement.",
    ],
  },
  {
    question: "Pourquoi héberger votre site au Maroc ?",
    answer:
      "Héberger votre site au Maroc offre plusieurs avantages : des temps de chargement plus rapides pour vos visiteurs marocains, une conformité avec la réglementation locale, la souveraineté de vos données sur le territoire national, et un support technique qui comprend parfaitement le contexte local.",
  },
  {
    question: "Quelle pack d'hébergement web conviendra à votre projet web ?",
    answer:
      "Le choix du pack dépend de plusieurs facteurs : le trafic attendu, le type de site (vitrine, e-commerce, blog), les ressources nécessaires (stockage, bande passante), et votre budget. Notre équipe peut vous conseiller gratuitement pour choisir le pack le plus adapté à votre projet.",
  },
];
---

<section class="bg-gray-100 py-[150px]">
  <div class="container">
    <h2 class="title-section mb-[50px]">FAQ – Hébergement web</h2>

    <div class="flex md:flex-row flex-col gap-6">
      <!-- Left Column -->
      <div class="col-span-1 flex flex-col gap-6">
        {faqData.slice(0, 3).map((item, index) => (
          <div class="w-full transition-shadow duration-300">
            <button
              data-faq-button
              data-index={index}
              class="w-full bg-white rounded-lg px-6 py-5 flex items-center justify-between text-left group"
              aria-expanded="false"
            >
              <span class="text-lg font-semibold text-title pr-4 transition-colors duration-300">
                {item.question}
              </span>
              <svg
                class="faq-icon w-6 h-6 text-primary flex-shrink-0 transition-transform duration-300"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width={2}
                  d="M19 9l-7 7-7-7"
                />
              </svg>
            </button>

            <div
              data-faq-content
              data-index={index}
              class="overflow-hidden max-h-0 opacity-0 transition-all duration-300"
            >
              <div class="px-6 pb-6 pt-10 text-[#022545] leading-relaxed">
                {item.answer && (
                  <div class="font-normal" set:html={item.answer} />
                )}
                {item.answers && (
                  <>
                    {item.answers.map((phrase, idx) => (
                      <p class={idx < item.answers.length - 1 ? "mb-6 font-normal" : "font-normal"}>
                        {phrase}
                      </p>
                    ))}
                  </>
                )}
              </div>
            </div>
          </div>
        ))}
      </div>

      <!-- Right Column -->
      <div class="col-span-1 flex flex-col gap-6">
        {faqData.slice(3, 7).map((item, index) => (
          <div class="transition-shadow duration-300">
            <button
              data-faq-button
              data-index={index + 3}
              class="w-full bg-white rounded-lg px-6 py-5 flex items-center justify-between text-left group"
              aria-expanded="false"
            >
              <span class="text-lg font-semibold text-title pr-4 transition-colors duration-300">
                {item.question}
              </span>
              <svg
                class="faq-icon w-6 h-6 text-primary flex-shrink-0 transition-transform duration-300"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width={2}
                  d="M19 9l-7 7-7-7"
                />
              </svg>
            </button>

            <div
              data-faq-content
              data-index={index + 3}
              class="overflow-hidden max-h-0 opacity-0 transition-all duration-300"
            >
              <div class="px-6 pb-6 pt-10 text-[#022545] leading-relaxed">
                {item.answer && <p>{item.answer}</p>}
                {item.answers && (
                  <>
                    {item.answers.map((phrase, idx) => (
                      <p class={idx < item.answers.length - 1 ? "mb-6" : ""}>
                        {phrase}
                      </p>
                    ))}
                  </>
                )}
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  </div>
</section>

<script>
  // Lightweight vanilla JS - no React overhead!
  document.addEventListener('DOMContentLoaded', () => {
    const buttons = document.querySelectorAll('[data-faq-button]');
    let currentOpen: number | null = null;

    buttons.forEach((button) => {
      button.addEventListener('click', () => {
        const index = parseInt(button.getAttribute('data-index') || '0');
        const content = document.querySelector(`[data-faq-content][data-index="${index}"]`);
        const icon = button.querySelector('.faq-icon');
        
        if (!content || !icon) return;

        // Close previously open item if different
        if (currentOpen !== null && currentOpen !== index) {
          const prevContent = document.querySelector(`[data-faq-content][data-index="${currentOpen}"]`);
          const prevButton = document.querySelector(`[data-faq-button][data-index="${currentOpen}"]`);
          const prevIcon = prevButton?.querySelector('.faq-icon');
          
          if (prevContent) {
            prevContent.classList.remove('max-h-[2000px]', 'opacity-100', 'pt-10');
            prevContent.classList.add('max-h-0', 'opacity-0');
          }
          if (prevButton) prevButton.setAttribute('aria-expanded', 'false');
          if (prevIcon) prevIcon.classList.remove('rotate-180');
        }

        // Toggle current item
        const isOpen = content.classList.contains('max-h-[2000px]');
        
        if (isOpen) {
          content.classList.remove('max-h-[2000px]', 'opacity-100', 'pt-10');
          content.classList.add('max-h-0', 'opacity-0');
          button.setAttribute('aria-expanded', 'false');
          icon.classList.remove('rotate-180');
          currentOpen = null;
        } else {
          content.classList.remove('max-h-0', 'opacity-0');
          content.classList.add('max-h-[2000px]', 'opacity-100', 'pt-10');
          button.setAttribute('aria-expanded', 'true');
          icon.classList.add('rotate-180');
          currentOpen = index;
        }
      });
    });
  });
</script>